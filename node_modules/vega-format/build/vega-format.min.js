!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-array"),require("d3-format"),require("vega-time"),require("vega-util"),require("d3-time-format")):"function"==typeof define&&define.amd?define(["exports","d3-array","d3-format","vega-time","vega-util","d3-time-format"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).vega={},e.d3,e.d3,e.vega,e.vega,e.d3)}(this,(function(e,t,r,a,i,o){"use strict";function n(e){const t={};return r=>t[r]||(t[r]=e(r))}function c(e){const a=n(e.format),i=e.formatPrefix;return{format:a,formatPrefix:i,formatFloat(e){const t=r.formatSpecifier(e||",");if(null==t.precision){switch(t.precision=12,t.type){case"%":t.precision-=2;break;case"e":t.precision-=1}return i=a(t),o=a(".1f")(1)[1],e=>{let t,r,a=i(e),n=a.indexOf(o);if(n<0)return a;for(t=function(e,t){let r,a=e.lastIndexOf("e");if(a>0)return a;for(a=e.length;--a>t;)if(r=e.charCodeAt(a),r>=48&&r<=57)return a+1}(a,n),r=t<a.length?a.slice(t):"";--t>n;)if("0"!==a[t]){++t;break}return a.slice(0,t)+r}}return a(t);var i,o},formatSpan(e,o,n,c){c=r.formatSpecifier(null==c?",f":c);const f=t.tickStep(e,o,n),u=Math.max(Math.abs(e),Math.abs(o));let s;if(null==c.precision)switch(c.type){case"s":return isNaN(s=r.precisionPrefix(f,u))||(c.precision=s),i(c,u);case"":case"e":case"g":case"p":case"r":isNaN(s=r.precisionRound(f,u))||(c.precision=s-("e"===c.type));break;case"f":case"%":isNaN(s=r.precisionFixed(f))||(c.precision=s-2*("%"===c.type))}return a(c)}}}let f,u;function s(){return f=c({format:r.format,formatPrefix:r.formatPrefix})}function m(e){return c(r.formatLocale(e))}function l(e){return arguments.length?f=m(e):f}function p(e,t,r){r=r||{},i.isObject(r)||i.error("Invalid time multi-format specifier: "+r);const o=t(a.SECONDS),n=t(a.MINUTES),c=t(a.HOURS),f=t(a.DATE),u=t(a.WEEK),s=t(a.MONTH),m=t(a.QUARTER),l=t(a.YEAR),p=e(r[a.MILLISECONDS]||".%L"),d=e(r[a.SECONDS]||":%S"),g=e(r[a.MINUTES]||"%I:%M"),S=e(r[a.HOURS]||"%I %p"),h=e(r[a.DATE]||r[a.DAY]||"%a %d"),E=e(r[a.WEEK]||"%b %d"),F=e(r[a.MONTH]||"%B"),b=e(r[a.QUARTER]||"%B"),x=e(r[a.YEAR]||"%Y");return e=>(o(e)<e?p:n(e)<e?d:c(e)<e?g:f(e)<e?S:s(e)<e?u(e)<e?h:E:l(e)<e?m(e)<e?F:b:x)(e)}function d(e){const t=n(e.format),r=n(e.utcFormat);return{timeFormat:e=>i.isString(e)?t(e):p(t,a.timeInterval,e),utcFormat:e=>i.isString(e)?r(e):p(r,a.utcInterval,e),timeParse:n(e.parse),utcParse:n(e.utcParse)}}function g(){return u=d({format:o.timeFormat,parse:o.timeParse,utcFormat:o.utcFormat,utcParse:o.utcParse})}function S(e){return d(o.timeFormatLocale(e))}function h(e){return arguments.length?u=S(e):u}s(),g();const E=(e,t)=>i.extend({},e,t);function F(e,t){const r=arguments.length;return r&&2!==r&&i.error("defaultLocale expects either zero or two arguments."),r?E(l(e),h(t)):E(l(),h())}e.defaultLocale=F,e.locale=function(e,t){const r=e?m(e):l(),a=t?S(t):h();return E(r,a)},e.numberFormatDefaultLocale=l,e.numberFormatLocale=m,e.resetDefaultLocale=function(){return s(),g(),F()},e.resetNumberFormatDefaultLocale=s,e.resetTimeFormatDefaultLocale=g,e.timeFormatDefaultLocale=h,e.timeFormatLocale=S,Object.defineProperty(e,"__esModule",{value:!0})}));